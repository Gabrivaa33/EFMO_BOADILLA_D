<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fantasy EFMO</title>
  <link rel="icon" href="favicon.ico" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glass { background: linear-gradient(135deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); }
    .injury { color: #fff; background: #ef4444; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; }
    .available { color: #fff; background: #10b981; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; }
    .doubt { color: #000; background: #facc15; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; }
    .score-badge { display: inline-block; min-width: 24px; text-align: center; padding: 2px 4px; border-radius: 4px; font-size: 0.75rem; font-weight: 500; margin-right: 2px; }
    .score-red { background-color: #ff3200; color: #000; }
    .score-gray { background-color: #d6d6d6; color: #000; }
    .score-yellow { background-color: #ffff42; color: #000; }
    .score-green { background-color: #23d750; color: #000; }
    .score-blue { background-color: #4bffff; color: #000; }
    .score-null { background-color: #d6d6d6; color: #000; }
    .cursor-pointer { cursor: pointer; }
  </style>
</head>
<body class="bg-slate-900 text-slate-100 antialiased">
<div class="max-w-6xl mx-auto p-6">
  <header class="flex items-center justify-between mb-6">
    <div>
      <h1 class="text-2xl font-extrabold">Fantasy EFMO</h1>
      <p class="text-slate-400 text-sm">Puntos, estad√≠sticas, y mucho m√°s</p>
    </div>
  </header>

  <main class="grid lg:grid-cols-3 gap-6">
    <section class="glass p-4 rounded-lg lg:col-span-1">
      <h2 class="font-semibold mb-3">Resumen</h2>
      <div class="space-y-3">
        <div class="flex items-center justify-between">
          <div class="text-sm text-slate-400">Jugadores</div>
          <div id="playerCount" class="font-bold">25</div>
        </div>
        <div class="flex items-center justify-between">
          <div class="text-sm text-slate-400">Lesionados</div>
          <div id="injuredCount" class="font-bold">0</div>
        </div>
      </div>

      <hr class="my-4 border-slate-700"/>
      <h3 class="font-semibold mb-2">Filtros</h3>
      <div class="space-y-2">
        <select id="positionFilter" class="w-full p-2 bg-slate-800 rounded">
          <option value="all">Todas las posiciones</option>
          <option value="Portero">Portero</option>
          <option value="Defensa">Defensa</option>
          <option value="Centrocampista">Centrocampista</option>
          <option value="Atacante">Atacante</option>
        </select>

        <select id="statusFilter" class="w-full p-2 bg-slate-800 rounded">
          <option value="all">Todos los estados</option>
          <option value="OK">Disponible</option>
          <option value="Lesionado">Lesionado</option>
          <option value="Duda">Duda</option>
        </select>
      </div>
    
      <hr class="my-4 border-slate-700"/>
      <h3 class="font-semibold mb-2">Noticias</h3>
      <div id="injuryFeed" class="space-y-3 text-sm text-slate-300">
    
    </section>
    
    <section class="lg:col-span-2">
      <div id="playerList" class="glass p-3 rounded-lg overflow-hidden">
        <div id="gridView" class="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 mt-3"></div>
      </div>
    </section>
  </main>

  <div id="statModal" class="fixed inset-0 hidden items-center justify-center bg-black/50">
    <div class="bg-slate-800 rounded-lg w-11/12 max-w-2xl p-4">
      <div class="flex items-start justify-between">
        <h3 id="modalName" class="text-xl font-bold">Nombre jugador</h3>
        <button id="closeModal" class="text-slate-400">Cerrar ‚úï</button>
      </div>
      <div class="mt-3 text-sm text-slate-300 grid grid-cols-3 gap-3">
        <div><strong>Puntos:</strong> <span id="modalPoints">0</span></div>
        <div><strong>Minutos:</strong> <span id="modalMinutes">0</span></div>
        <div><strong>Media Puntos:</strong> <span id="modalAvgPoints">0</span></div>
        <div><strong>Goles:</strong> <span id="modalGoals">0</span></div>
        <div><strong>Asistencias:</strong> <span id="modalAssists">0</span></div>
        <div><strong>Tarjetas amarillas:</strong> <span id="modalCards">0</span></div>
      </div>
      <div class="mt-4 text-sm text-slate-400">√öltimas actuaciones</div>
      <div id="modalPerformances" class="mt-2 space-y-2 text-slate-300 text-xs"></div>
    </div>
  </div>
</div>

<script>
const players = [
  { id:1, name:'Edu', pos:'Portero', status:'OK', performances:[
    {points:4, minutes:35, goals:0, assists:0, cards:0, comment:'‚Ü™Ô∏è (6,8)'},
    {points:5, minutes:35, goals:0, assists:0, cards:0, comment:'‚Ü©Ô∏è (7,0)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:2, name:'Rodri', pos:'Portero', status:'OK', performances:[
    {points:6, minutes:35, goals:0, assists:0, cards:0, comment:'‚Ü©Ô∏è (7,2)'},
    {points:3, minutes:35, goals:0, assists:0, cards:0, comment:'‚Ü™Ô∏è (6,7)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:3, name:'Thiago', pos:'Defensa', status:'OK', performances:[
    {points:4, minutes:61, goals:0, assists:0, cards:0, comment:'‚Ü™Ô∏è (6,8)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:4, name:'Pablo', pos:'Defensa', status:'OK', performances:[
    {points:8, minutes:56, goals:0, assists:0, cards:0, comment:'‚Ü™Ô∏è‚Ü©Ô∏è (7,6)'},
    {points:7, minutes:70, goals:0, assists:0, cards:0, comment:'(7,4)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:5, name:'Yago', pos:'Defensa', status:'Duda', performances:[
    {points:6, minutes:30, goals:0, assists:0, cards:0, comment:'‚Ü™Ô∏è‚Ü©Ô∏è (7,3)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:6, name:'Alonso', pos:'Defensa', status:'OK', performances:[
    {points:5, minutes:23, goals:0, assists:0, cards:0, comment:'‚Ü©Ô∏è‚Ü™Ô∏è‚Ü©Ô∏è (7,0)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:7, name:'Lucas S.', pos:'Defensa', status:'OK', performances:[
    {points:-1, minutes:40, goals:0, assists:0, cards:1, comment:'üü®‚Ü©Ô∏è‚Ü™Ô∏è (5,9)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:8, name:'Mario', pos:'Defensa', status:'OK', performances:[
    {points:13, minutes:70, goals:1, assists:0, cards:0, comment:'‚öΩ (7,7+‚öΩ)'},
    {points:6, minutes:0, goals:0, assists:0, cards:0, comment:'(7,2)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:9, name:'Lucas G.', pos:'Defensa', status:'OK', performances:[
    {points:6, minutes:54, goals:0, assists:0, cards:0, comment:'‚Ü™Ô∏è‚Ü©Ô∏è‚Ü™Ô∏è (7,3)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:10, name:'Papu', pos:'Defensa', status:'OK', performances:[
    {points:3, minutes:16, goals:0, assists:0, cards:0, comment:'‚Ü©Ô∏è‚Ü™Ô∏è‚Ü©Ô∏è (6,7)'},
    {points:null, minutes:0, goals:0, assists:0, cards:1, comment:'üü®'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:11, name:'√ç√±igo', pos:'Centrocampista', status:'Duda', performances:[
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'No convocado'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'No convocado'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:12, name:'Esteban', pos:'Centrocampista', status:'OK', performances:[
    {points:13, minutes:52, goals:1, assists:0, cards:0, comment:'‚Ü™Ô∏è‚Ü©Ô∏è‚öΩ (7,8+‚öΩ)'},
    {points:null, minutes:0, goals:0, assists:0, cards:1, comment:'üü®'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:13, name:'Nacho', pos:'Centrocampista', status:'OK', performances:[
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'No convocado'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'No convocado'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:14, name:'Marcos', pos:'Centrocampista', status:'OK', performances:[
    {points:4, minutes:32, goals:0, assists:0, cards:0, comment:'‚Ü©Ô∏è‚Ü™Ô∏è (6,8)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:15, name:'Gonzalo', pos:'Centrocampista', status:'OK', performances:[
    {points:7, minutes:56, goals:0, assists:0, cards:0, comment:'‚Ü™Ô∏è‚Ü©Ô∏è (7,4)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:16, name:'Gasc√≥n', pos:'Centrocampista', status:'OK', performances:[
    {points:9, minutes:40, goals:1, assists:0, cards:0, comment:'‚Ü©Ô∏è‚Ü™Ô∏è‚öΩ (7,3+‚öΩ)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:17, name:'Javi', pos:'Centrocampista', status:'OK', performances:[
    {points:9, minutes:56, goals:0, assists:1, cards:0, comment:'‚Ü™Ô∏è‚Ü©Ô∏èüÖ∞Ô∏è (7,6+üÖ∞Ô∏è)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:18, name:'Diego', pos:'Atacante', status:'OK', performances:[
    {points:6, minutes:62, goals:0, assists:0, cards:0, comment:'‚Ü™Ô∏è‚Ü©Ô∏è (7,3)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:19, name:'Sergio', pos:'Atacante', status:'Duda', performances:[
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'No convocado'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]},
  
  { id:20, name:'Lucas O.', pos:'Atacante', status:'OK', performances:[
    {points:16, minutes:52, goals:2, assists:0, cards:0, comment:'‚Ü™Ô∏è‚Ü©Ô∏è‚öΩ‚öΩüÖøÔ∏è (8,3+‚öΩ+‚öΩüÖøÔ∏è)'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'},
    {points:null, minutes:0, goals:0, assists:0, cards:0, comment:'-'}]}
];

// üì∞ Noticias del equipo
const news = [
  { playerId: 5, title: 'Duda', text: "Golpe en la cabeza, Desconocido" },
  { playerId: null, title: 'Jornada 1', text: "E.F.M.O. Boadilla 'D' 5-1 Agrup. Lucero Linces 'B'" },
  { playerId: 11, title: 'Duda', text: "Enfermedad, 1-2 semanas" },
  { playerId: 19, title: 'Duda', text: "Enfermedad, 1-2 semanas" },
  { playerId: null, title: 'Lesiones', text: "Para ver las lesiones o dudas, clica en el jugador y ver√°s la informaci√≥n sobre su estado" }
];
  
// Render helpers
function renderScoreBadge(score){
  if(score===null) return `<span class='score-badge score-null'>-</span>`;
  if(score<0) return `<span class='score-badge score-red'>${score}</span>`;
  if(score===0) return `<span class='score-badge score-gray'>${score}</span>`;
  if(score>=1 && score<=4) return `<span class='score-badge score-yellow'>${score}</span>`;
  if(score>=5 && score<=9) return `<span class='score-badge score-green'>${score}</span>`;
  return `<span class='score-badge score-blue'>${score}</span>`;
}

function renderStatusBadge(p){
  if(p.status==='Lesionado') return `<span class='injury'>Lesionado</span>`;
  if(p.status==='Duda') return `<span class='doubt'>Duda</span>`;
  return `<span class='available'>Disponible</span>`;
}

function calculateTotals(perfs){
  return perfs.reduce((acc,p)=>{
    if(p.points!==null) acc.points+=p.points;
    acc.minutes+=p.minutes;
    acc.goals+=p.goals;
    acc.assists+=p.assists;
    acc.cards+=p.cards;
    return acc;
  }, {points:0, minutes:0, goals:0, assists:0, cards:0});
}

function calculateAvg(perfs){
  const valid = perfs.filter(p=>p.points!==null).map(p=>p.points);
  if(valid.length===0) return 0;
  return (valid.reduce((a,b)=>a+b,0)/valid.length).toFixed(2);
}
  
function renderInjuryFeed(){
  const feed = document.getElementById('injuryFeed');
  feed.innerHTML = '';

  // Solo mostrar noticias generales (sin jugador vinculado)
  const generalNews = news.filter(n => n.playerId === null);

  generalNews.forEach(n => {
    const div = document.createElement('div');
    div.className = 'p-2 bg-slate-800 rounded text-sm';
    div.innerHTML = `
      <div class="font-medium">${n.title}</div>
      <div class="text-slate-400 text-xs">${n.text}</div>
    `;
    feed.appendChild(div);
  });
}
  
function render(){
  const grid=document.getElementById('gridView');
  const posFilter=document.getElementById('positionFilter').value;
  const statusFilter=document.getElementById('statusFilter').value;
  const filtered=players.filter(p=>(posFilter==='all'||p.pos===posFilter)&&(statusFilter==='all'||p.status===statusFilter));
  grid.innerHTML='';

  filtered.forEach(p=>{
    const lastThree = p.performances.slice(-3);
    const totalPoints = calculateTotals(p.performances).points;

    let bgClass = '';
    if (p.status === 'OK') bgClass = 'bg-green-800';
    else if (p.status === 'Lesionado') bgClass = 'bg-red-800';
    else if (p.status === 'Duda') bgClass = 'bg-yellow-600';
    else bgClass = 'bg-slate-800';

    const card = document.createElement('div');
    card.className = `p-3 ${bgClass} rounded-lg cursor-pointer`;

    card.innerHTML=`
      <div class='flex items-start justify-between'>
        <div>
          <div class='text-sm text-slate-400'>${p.pos}</div>
          <div class='font-semibold'>${p.name}</div>
        </div>
        <div class='text-right'>
          <div class='text-xs text-slate-400'>Puntos</div>
          <div class='text-lg font-bold'>${totalPoints}</div>
        </div>
      </div>
      <div class='mt-3'>
        ${lastThree.map(l=>renderScoreBadge(l.points)).join(' ')}
      </div>
      <div class='mt-2'>${renderStatusBadge(p)}</div>
    `;
    card.onclick=()=>openModal(p.id);
    grid.appendChild(card);
  });

  document.getElementById('playerCount').textContent=players.length;
  document.getElementById('injuredCount').textContent =
    players.filter(p => p.status === "Lesionado").length;

renderInjuryFeed(); // üîî Actualiza las noticias
  
}

function openModal(id){
  const p=players.find(x=>x.id===id); if(!p) return;
  document.getElementById('modalName').textContent=p.name;
  const totals = calculateTotals(p.performances);
  document.getElementById('modalPoints').textContent = totals.points;
  document.getElementById('modalMinutes').textContent = totals.minutes;
  document.getElementById('modalGoals').textContent = totals.goals;
  document.getElementById('modalAssists').textContent = totals.assists;
  document.getElementById('modalCards').textContent = totals.cards;
  document.getElementById('modalAvgPoints').textContent = calculateAvg(p.performances);

  const perfDiv=document.getElementById('modalPerformances'); perfDiv.innerHTML='';
   
  // üì∞ Mostrar noticia asociada (si existe)
  const playerNews = news.find(n => n.playerId === p.id);
  if (playerNews) {
    const newsDiv = document.createElement('div');
    newsDiv.className = 'p-2 bg-slate-700 rounded text-xs text-red-300 italic mb-2';
    newsDiv.innerHTML = `<strong>${playerNews.title}:</strong> ${playerNews.text}`;
    perfDiv.appendChild(newsDiv);
  }

  p.performances.forEach((perf,i)=>{
    const div=document.createElement('div');
    div.className='p-2 bg-slate-700 rounded flex justify-between items-center';
    div.innerHTML=`<span>Jornada ${i+1}: ${renderScoreBadge(perf.points)}</span><span>${perf.comment}</span>`;
    perfDiv.appendChild(div);
  });
  document.getElementById('statModal').classList.remove('hidden');
  document.getElementById('statModal').classList.add('flex');
}

document.getElementById('positionFilter').addEventListener('change',render);
document.getElementById('statusFilter').addEventListener('change',render);
document.getElementById('closeModal').addEventListener('click',()=>{
  document.getElementById('statModal').classList.add('hidden');
  document.getElementById('statModal').classList.remove('flex');
});

render();
</script>
</body>
</html>
